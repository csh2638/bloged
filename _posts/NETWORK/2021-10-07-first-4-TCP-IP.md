---
layout: post
title: "[NETWORK] TCP/IP 프로토콜"
categories: NETWORK
tags: [NETWORK, TCP/IP]
---

## TCP/IP 프로토콜

인터넷에서 사용되는 핵심 프로토콜은 TCP와 IP로 리를 비록한 각종 프로토콜을 총칭하여 TCP/IP프로토콜이라 부른다. TCP/IP 프로토콜은 운영체제의 일부로 구현되며,
응용 프로그램은 운영체제가 제공하는 TCP/IP 프로토놀의 서비스를 사용해 통신한다. TCP/IP 프로토콜에서 통신을 수행하는 주체이자 통신의 최종 목적지는 호스트 자체가 아닌
호스트에서 수행하는 응용 프로그램이라는 점을 기억해야 한다.

일반적으로 프로토콜은 기능별로 나누어 계층적으로 구현하는데 TCP/IP프초토콜도 이 구조를 따른다. 응용 계층, 전송 계층, 인터넷 계층, 네트워크 접근 계층으로 나뉜다.

## 네트워크 접근 계층(network access layer)

네트워크 접근 계층은 물리적 네트워크를 통한 실제 데이터의 송수신을 담당한다. 구성 요소로는 물리적 신호를 처리해 데이터를 송수신하는 네트워크 하드웨어와 운영체제게 제공하는 장치 드라이버가 있다. 네트워크 접근 계층에서는 하드웨어적으로 정의된 물리주소를 사용해 통신하는데, 물리 주소는 네트워크 방식에 따라 다르며 일반적으로 상호 호환되지 않는다.

## 인터넷 계층(internet layer)

인터넷 계층은 네트워크 접근계층의 도움을 받아 데이터를 목적지인 호스트까지 전달하는 역할을 한다. 네트워크 접근 계층과 마찬가지로 주소를 지정하는 방법이 필요한데, 하드웨어적으로 정의된
물리 주소 대신 소프트웨어적으로 정의된 논리 주소인 IP주소(Internet Protocol address)를 사용한다.

IP주소는 네트워크 접근 계층에서 사용하는 물리 주소와는 별개로 정의하며, 전 세계적으로 유일성을 보장한다. IP주소의 유일성과 하드웨어 독립성 덕분에 TCP/IP프로토콜은 다양한 네트워크 기술과 하드웨어에서 작동할 수 있으며, 이를 통해 전 세계적인 네트워크인 인터넷을 만들 수 있게 되었다.

IP주소는 통신에 참여하는 호스트를 유일하게 지정하는 방법을 제공하지만, 실제 통신을 하려면 전송 경로를 지정하고 그에 따라 데이터를 전달하는 절차가 필요한데 이를 라우팅이라고 한다.

### 라우팅(routing)

라우팅은 데이터를 목적지까지 전달하는 일련의 작업을 가리키는 용어로, 라우팅에 필요한 정보를 수집하는 작업과 라우팅 정보를 기초로 실제 데이터를 전달하는 작업을 포함한다. 라우팅을 담당하는 전용장비를 라우터라 하며 이 라우터를 통해 서로다른 네트워크에 연결된 호스트끼리 통신할 수 있다.

## 전송 계층(transport layer)

전송계층은 최종 통신 목적지를 지정하고 오류 없이 데이터를 전송하는 역할을 한다. 앞서 나온 인터넷 계층의 역할은 IP주소와 라우팅을 이용해 목적지 호스트에 데이터가 도달할 수 있게 하는 것이다. 그러나 통신의 최종 목적지는 호스트가 아닌 해당 호스트에서 실행하고 있는 프로세스(응용 프로그램)이다. 따라서 전송 계층에서 프로세스를 지정하는 일종의 주소인 포트 번호(port number)를 사용한다.

인터넷 계층의 IP가 제공하는 전송 서비스는 최선을 다하지만 신뢰성이 없는 특징이 있다. 이는 데이터에 문제가 생기면 목적지에 도달하지 못하는 상황이 발생할 수 있고, 목적지에 도달해도 실제 데이터의 내용이 손상 가능성이 있음을 말한다. 이러한 데이터의 손실 또는 손상을 검출해 잘못된 데이터가 목적지에 전달되는 일을 방지한다.

전송계층에 해당하는 TCP/IP프로토콜로는 TCP(Transmission Control Protocol)와 UDP(User Datagram Protocol)이 있다.

|TCP|vs|UDP|
|------|---|---|
|연결형 프로토콜(연결 설정 후 통신가능)||비연결형 프로토콜(연결 설정 없이 통신가능)|
|신뢰성 있는 데이터 전송(데이터를 재전송함)||신뢰성 없는 데이터 전송(데이터를 재전송하지 않음)|
|일대일 통신||일대일 통신, 일대다 통신|
|데이터 경계 구분 안함, 바이트 스트림||데이터의 경계 구분, 데이터그램|

## 응용 계층(application layer)

응용 계층은 전송 계층을 기반으로한 다수의 프로토콜(Telnet, FTP, HTTP, SMTP등)과 이 프로토콜을 사용하는 응용 프로그램을 포괄한다. 소켓을 사용한 네트워크 프로토콜도 여기에 해당한다.


## 데이터 전송 원리

송신 측 호스트의 응용 프로그램이 보내는 데이터를 수신 측 호스트의 응용 프로그램에 전송하려면 각 프로토콜에서 정의한 제어정보(IP주소, 포트번호, 오류 체크 코드)등이 필요하다.
제어정보는 위치에 따라 앞쪽에 붙는 **헤더** , 뒤쪽에 붙는 **트레일러** 로 나뉜다. 데이터는 이러한 제어 정보가 결합된 형태로 전송되며 이를 **패킷** 이라 부른다. 즉 패킷은 제어정보 + 데이터로 정의할 수 있다.

이더넷에 연결된 두 호스트가 TCP/IP를 사용해 데이터를 교환하느 경우 패킷의 전송형태는 다음과 같다.

![ddd](https://user-images.githubusercontent.com/78485996/136588757-de2c1b50-49cb-4811-9aa9-6a0805c78e3e.PNG)



## IP주소, Port번호

TCP/IP 프로토콜을 사용해 통신할 때는 IP주소와 포트번호를 사용한다. 

IP주소의 경우 IPv4, IPv6 두 종류가 있으며 각각 32비트와 128비트값을 사용한다. IPv4는 8비트 단위로 .(dot)으로 구분하여 10진수 4개로 표현하며, IPv6는 16비트 단위로 :(colon)으로 구분하여 16진수 8개로 표현한다

IPv4 주소 : 147.46.114.70

IPv6 주소 : 0:0:0:0:0:ffff:192.1.56.10


폐쇠된 경우나 IP를 공유하는 경우가 아니라면 IP주소는 전 세계적으로 값이 유일하다. 라우터가 라우팅을 할 때는 IP 헤더에 포함된 수신자 IP 주소를 사용하며. 데이터를 받은 쪽에서 답장을 보낼 때는 IP 헤더에 포함된 송신자 IP 주소를 사용한다.

IP주소는 인터넷에 있는 호스트를 유일하게 구별할 수 있지만 통신의 최종 주체인 프로세스는 식별하지 못한다. 프로세스 식별자로는 포트 번호를 사용하는데, 흔히 포트번호는 각 프로세스를 구별하는 식별자로 알려져 있다. 그러나 실제로는 한 프로세스가 포트 번호 두 개 이상 사용하는 경우가 종종 있으며, 둘 이상의 프로세스가 하나의 포트 번호를 사용할 수도 있다. 따라서 포트번호는 프로세스를 구별하는 식별자라기보다는 통신의 종착점을 나타내는 식별자로 보는 것이 바람직하다.

TCP와 UDP는 포트번호로 부호없는 16비트 정수를 사용하므로 0~65535 범위가 가능하지만 0~1023은 용도가 정해져 있어 사용하면 안된다.


## 클라이언트-서버 모델

네트워크 프로그램은 일반적으로 클라이언트-서버 모델로 작성한다. 서비스를 요청하는 쪽을 클라이언트, 클라이언트가 요청한 서비스를 처리하는 쪽을 서버라고 부른다.
클라이언트-서버 모델을 한 컴퓨터에서 실행되는 두 프로그램에 적용할 경우에는 다양한 프로세스간 통신 기법을 사용해 데이터를 주고받을 수 있는 반면 , 네트워크로 연결된 컴퓨터에서 실행되는 두 프로그램에 적용할 경우에는 반드시 통신 프로토콜을 사용해야 데이터를 주고 받을 수 있다.









